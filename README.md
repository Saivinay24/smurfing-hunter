# Smurfing Hunter: Money Laundering Detection System

**Domain**: RegTech / Crypto-Forensics / Graph Theory  
**Solution Type**: Graph Analysis & Pattern Recognition System

---

## ðŸš€ Problem Statement

Decentralized Finance (DeFi) allows for anonymous transfers, but regulators require compliance with Anti-Money Laundering (AML) laws. A common laundering technique is **"Smurfing"** or **"Layering,"** where a large sum of dirty money is broken into hundreds of small transactions (fan-out), passed through multiple intermediate wallets (layering), and then re-aggregated (fan-in).

**Challenges addressed:**
1.  **Topology Identification**: Detecting "Fan-out / Fan-in", "Cyclic", and "Gather-Scatter" patterns.
2.  **Obfuscation Breaking**: Identifying "Peeling Chains" and accounting for time delays/amount variations.

---

## ðŸ’¡ Solution Overview

**Smurfing Hunter** is a comprehensive Python-based forensic tool that detects, analyzes, and visualizes money laundering patterns in blockchain transaction networks.

### Technical Stack
-   **Core**: `Python 3.8+`
-   **Graph Processing**: `NetworkX` (Directed Graph Analysis)
-   **Data Processing**: `Pandas`, `NumPy`
-   **Visualization**: `PyVis` (Interactive), `Matplotlib` (Static)
-   **Statistics**: `SciPy` (Z-score anomaly detection)

### Key Features (Eval Ready)
1.  **Pattern Detection Engine**:
    -   **Fan-out/Fan-in**: Identifies split and merge topologies with **Strict Temporal Validation** ($Time_A < Time_B < Time_C$) enforcing chronological causality.
    -   **Peeling Chains**: Detects sequential small withdrawals (1-2% gas fees) with **Flow Conservation** logic to identify obfuscation patterns.
    -   **Cyclic Graphs**: Finds money flowing in loops to obscure origin, with temporal checks to prevent false positives.
    -   **Layered Laundering**: Traces multi-hop paths from known illicit sources through intermediate wallets.

2.  **Suspicion Scoring Model (0-100)**:
    -   Weighted formula: $Score = \alpha \times Centrality + \beta \times Proximity\_to\_Illicit + \gamma \times Pattern\_Involvement + \delta \times Structural\_Anomaly$
    -   Component weights: **Centrality (35%)**, **Illicit Proximity (35%)**, Pattern Involvement (20%), Structural Anomaly (10%)
    -   Combines graph metrics with behavioral analysis for comprehensive risk assessment.

3.  **Visualization Dashboard**:
    -   Interactive HTML graph with risk hotspots.
    -   Static reports of detected patterns.
    -   Distribution plots of suspicion scores.

### Technical Design Decisions

**Peeling Chain Threshold Selection:**  
We set the peeling chain detection threshold at **2%** based on real-world blockchain economics:

-   **Ethereum Gas Fees**: Typical transaction fees range from 0.5-1.5% of transaction value during normal network conditions
-   **Solana Fees**: Even lower (~0.00025 SOL per transaction), but intermediate wallet management adds overhead
-   **Obfuscation Overhead**: Laundering operations incur additional costs (exchange fees, bridge fees, mixer fees)
-   **Detection Window**: The 2% threshold captures realistic "peeling" behavior where small amounts (1-2%) are systematically withdrawn at each hop to pay for operational costs while preserving the bulk of illicit funds

This domain-informed threshold prevents false positives from legitimate transaction fees while detecting actual obfuscation patterns.

---

## ðŸ› ï¸ Installation

```bash
# 1. Clone the repository
git clone <repo-url>
cd smurfing-hunter

# 2. Create virtual environment (Optional but Recommended)
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 3. Install dependencies
pip install -r requirements.txt
```

---

## âš¡ Usage

### Quick Start (Verification Demo)
Run the complete end-to-end demonstration. This generates sample data, detects patterns, and builds the dashboard.

```bash
python scripts/run_demo.py
```
*Expected Output*: ~24 patterns detected, Risk Report generated, 5+ visualization files.

### Analyze Your Own Data
```bash
python run.py --transactions data/transactions.csv --illicit data/illicit_wallets.csv --output results
```

### Investigate Specific Wallet
```bash
python run.py --investigate 0x123abc...
```

---

## ðŸ“Š Results & Outcomes

The system produces a comprehensive `output/` directory containing:

1.  **`risk_report.txt`**: Detailed assessment of top suspicious wallets.
    -   *Example*: "Wallet 0x8f2... | Score: 92.5 (CRITICAL) | Involved in 3 Peeling Chains"
2.  **`visualizations/full_graph.html`**: Interactive network map.
    -   ðŸ”´ Red nodes: Known Illicit
    -   ðŸŸ  Orange nodes: High Risk (Score > 60)
3.  **Pattern Plots**: PNG images of every detected laundering topology.

---

## ðŸ“¸ Sample Visualizations

Below are actual outputs generated by `scripts/run_demo.py` from the provided `demo_results/`.

### 1. Risk Score Distribution
![Suspicion Score Distribution](demo_results/score_distribution.png)
*Distribution of wallet suspicion scores showing separation between normal and high-risk wallets.*

### 2. Network Statistics
![Network Statistics](demo_results/network_stats.png)
*Key graph metrics including degree distribution and centrality measures.*

### 3. Detected Smurfing Patterns
**Fan-out / Fan-in Pattern:**
![Fan-out Pattern](demo_results/pattern_1.png)

**Cyclic / Layered Pattern:**
![Cyclic Pattern](demo_results/pattern_2.png)

---

## ðŸ“‚ Project Structure

```text
.
â”œâ”€â”€ src/
â”‚   â””â”€â”€ smurfing_hunter/
â”‚       â”œâ”€â”€ core/
â”‚       â”‚   â”œâ”€â”€ smurfing_hunter.py   # Main analysis logic
â”‚       â”‚   â”œâ”€â”€ pattern_detector.py  # Pattern detection engine
â”‚       â”‚   â”œâ”€â”€ suspicion_scorer.py  # Risk scoring algorithm
â”‚       â”‚   â””â”€â”€ graph_builder.py     # Graph construction
â”‚       â”œâ”€â”€ utils/
â”‚       â”‚   â””â”€â”€ visualizer.py        # Dashboard generation
â”‚       â””â”€â”€ data/
â”‚           â””â”€â”€ generate_sample_data.py
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ run_demo.py              # End-to-end demonstration script
â”œâ”€â”€ data/                        # Data directory (created on run)
â”‚   â”œâ”€â”€ transactions.csv
â”‚   â””â”€â”€ illicit_wallets.csv
â”œâ”€â”€ run.py                       # Main CLI entry point
â”œâ”€â”€ requirements.txt             # Dependencies
â”œâ”€â”€ README.md                    # Documentation
â”œâ”€â”€ EVALUATION_DOSSIER.md        # Rubric-mapped project details
â””â”€â”€ demo_results/                # Example outputs
```
